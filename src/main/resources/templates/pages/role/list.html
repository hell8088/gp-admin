<!DOCTYPE html>
<html lang="zh" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/main.html}">
<body layout:fragment="content">
	<div class="layui-tab layui-tab-brief">
		<ul class="layui-tab-title">
			<li class="layui-this"><a href="#">角色管理</a></li>
		</ul>
	</div>
	<div class="layui-form layui-tab-content" id="LAY_ucm"
		style="padding: 5px 0;">
		<div class="layui-tab-item layui-show">
			<div class="layui-main">
				<!-- 主框架内 -->

				<table class="layui-hide" id="test" lay-filter="test"></table>

				<!-- /主框架内 -->
			</div>
		</div>
	</div>

	<script type="text/html" id="toolbarDemo">
  		<div class="layui-btn-container">
    		<button class="layui-btn layui-btn-sm" lay-event="add">新增角色</button>
  		</div>
	</script>
	
	<script type="text/html" id="checkboxTpl">
  		<input type="checkbox" name="lock" value="{{d.id}}" lay-skin="switch" lay-text="开启|停用" lay-filter="lockDemo" {{ d.available ? 'checked' : '' }}>
	</script>

	<script type="text/html" id="barDemo">
  		<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
  		<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
	</script>
              
	<script>
	layui.use('table', function(){
	  var table = layui.table,form = layui.form;
	  
	  table.render({
	    elem: '#test'
	    ,url: '/api/role/data'   //'/assets/demodata/table1.json'
	    ,toolbar: '#toolbarDemo'
	    ,title: '角色数据表'
	    ,cols: [
	    	[
		        //{type: 'checkbox', fixed: 'left'}
		        //{field:'id', title:'角色ID'},
		    	{field:'role', title:'角色'},
		    	{field:'description', title:'角色描述'},
		    	{field:'modifier', title:'修改人'},
		    	{field:'modifiedDate', title:'修改时间', templet:"<div>{{layui.util.toDateString(d.modifiedDate, 'yyyy-MM-dd HH:mm:ss')}}</div>"},
		    	{field:'available', title:'是否锁定', templet: '#checkboxTpl', unresize: true , width:120},
		    	{fixed: 'right', title:'操作', toolbar: '#barDemo', width:150}
	    	]
	    ]
	    ,page: true
	    ,limits: [5, 10, 15] //显示
        ,limit: 10 //每页默认显示的数量
	  });
	  
	  //头工具栏事件
	  table.on('toolbar(test)', function(obj){
		var checkStatus = table.checkStatus(obj.config.id);
		switch(obj.event){
		  case 'add':
			  window.open(BASE_URL + "role/edit?id=0&roleId=0","_self");
		  break;
		};
	  });
	  
	  //监听行工具事件
	  table.on('tool(test)', function(obj){
		var data = obj.data;
		//console.log(obj)
		if(obj.event === 'del'){
		  layer.confirm('真的删除行么', function(index){
		    obj.del();
		    layer.close(index);
		  });
		} else if(obj.event === 'edit'){
			window.open(BASE_URL + "role/edit?id="+data.id,"_self");
		}
	  });
	  
	  //监听
	  form.on('switch(lockDemo)', function(obj){
	  	alert(this.value);
	    layer.tips(this.value + ' ' + this.name + '：'+ obj.elem.checked, obj.othis);
	  });
	});
	
	
	</script>

</body>
</html>